<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carregando – MotoTec</title>

  <!-- CSS do Leaflet para o mapa de fundo -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <style>
    /* Remover margens/padding padrão e impedir scroll */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: #f3f4f6; /* cor neutra caso o mapa demore a carregar */
    }

    /* O mapa deverá ocupar 100% da tela */
    #map {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    /* Div branca semi‐opaca sobre o mapa, removida após o carregamento */
    #overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #ffffff;
      z-index: 2;
    }

    /* Container do logo, centralizado sobre o mapa */
    #logo-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 3;
      animation: fadeInOut 2.5s ease-in-out forwards;
    }

    /* Tamanho do logo */
    #logo {
      width: 180px;
      height: auto;
    }

    /* Animação de fade‐in / fade‐out para o logo */
    @keyframes fadeInOut {
      0% {
        opacity: 0;
        transform: translate(-50%, -60%) scale(0.8);
      }
      50% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(-50%, -40%) scale(1.2);
      }
    }
  </style>
</head>

<body>
  <!-- 1) Overlay branco para esconder o mapa até a splash terminar -->
  <div id="overlay"></div>

  <!-- 2) Mapa Leaflet como fundo animado -->
  <div id="map"></div>

  <!-- 3) Logo centralizado com animação -->
  <div id="logo-container">
    <img
      id="logo"
      src="{% static 'imagem/Logo.png' %}"
      alt="MotoTec Logo"
    />
  </div>

  <!-- Scripts do Leaflet (mapa) -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // Aguarda até o DOM carregar
    document.addEventListener("DOMContentLoaded", function () {
      // 1) Inicializa o mapa sem controles de zoom, centralizado em Praia Grande
      const map = L.map("map", {
        zoomControl: false,
        attributionControl: false
      }).setView([-24.0167, -46.4667], 13);

      // 2) Adiciona camada base do OpenStreetMap
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 18
      }).addTo(map);

      // 3) Função para fazer um “pan” horizontal suave (vai e volta)
      let direction = 1;
      setInterval(() => {
        // Desloca o mapa 20px horizontalmente
        map.panBy([direction * 20, 0], {
          animate: true,
          duration: 2  // 2 segundos de animação
        });

        // Se o centro estiver muito deslocado, inverte a direção
        const center = map.getCenter();
        if (center.lng > -46.3 || center.lng < -46.7) {
          direction *= -1;
        }
      }, 3000); // Executa a cada 3 segundos

      // 4) Após 3 segundos, remove o overlay e o logo, e redireciona para a home real
      setTimeout(() => {
        // Remove veias de splash
        const overlay = document.getElementById("overlay");
        const logoContainer = document.getElementById("logo-container");
        if (overlay) overlay.remove();
        if (logoContainer) logoContainer.remove();

        // Redireciona para a página principal (nome da URL “home”)
        window.location.href = "{% url 'home' %}";
      }, 3000);
    });
  </script>
</body>
</html>
